# FinTech
ScoreCard
项目：金融风控——信用贷款违约预测

1、项目背景

    为实现金融机构信用贷款违约预测目标，优化用户贷款质量，通过分析历史用户渠道数据，刻画潜在违约客户画像，并搭建LightGBM贷款违约分类模型,从用户基本信息、金融信息等维度建立评估体系来衡量客户贷款违约可能性；通过特征工程使模型验证集KS达到33.8%。

2、项目流程

    首先第一步是对数据做一些可视化分析,目标主要是两点:

    是对数据集中的缺失值、异常值、数据类型进行探索，为后面的数据处理做准备。
    是探索违约客户和非违约客户特征的分布情况，建立违约客户的基本画像，理解数据为后面的特征工程做基础。下面我来具体介绍一下：

  (1)数据可视化与数据清洗：
  
    首先是对缺失值的探索，在这里我先查看了不同特征的缺失分布情况，整体低于5%，因为选择的模型是lgb模型，可以自动对缺失值做出处理，此外，在信贷领域，缺失值有可能代表着一类单独信息，所以这里我没有对缺失值做一些填补操作；

    其次是时间格式处理，这里我对employmentLength（工作年限）,earliesCreditLine（最早信用开立月份）、issueDate(贷款发放日期)等数据做数据清洗工作；

    在数据质量做完探索后，我在对违约客户和非违约客户的特征分布做了一些探索，对违约客户的画像有了一个基本的概念，比如年收入越高，违约可能性越低，利率高，违约率就高、贷款年限高，违约率高，贷款等级高违约率低，fico信用分越高，违约率越低等。

  (2)特征工程:
  
  在对数据清洗完毕后是做特征工程，我主要是从业务特征构造，特征分箱、编码、等方面做特征工程。

    业务特征构造： 比如可以知道客户最早信用额度的开立时间（earliesCreditLine）和贷款发放日期（issueDate）的差值，我计算了客户的平均信用历史时间长度，这个时间越长说明客户具有越长的信用记录，其违约的可能性就越小。

      客户贷款金额（loanAmnt）与信贷周转余额(revolBal)的比率情况（越大，说明客户贷款申请金额占授信额度比重越大，违约可能性高）
      循环利用率('revolUtil)与信贷周转余额(revolBal)比率情况（循环利用率高，说明信用风险越小）
      未结信用额度(openAcc)与总信用额度(totalAcc)比率情况（越大，客户信用风险越高）
      贷款金额(loanAmnt)占总负债(dti*annualIncome)比例（越大，信用风险高）
      年收入与贷款金额(分期金额)占比（越大，说明客户还款能力越强）
      分期金额（installment）和年收入(annualIncome)的比值，这个比值越高，说明客户在每期还款压力相对较大，违约概率可能较高。
      针对违约客户画像特点，ficoRangeHigh、ficoRangeLow在值等于700处可以很好区分违约客户与非违约客户，故生成衍生变量将高于700分赋值0，低于700分赋予1；利率interestRate在14%处可以很好区分违约客户与非违约客户，同样生成衍生变量，高于14%的变量赋值1，低于14%的变量赋值0。
      类别特征编码

    grade、subGrade，term生成序数编码
    目标编码

    按类别变量关于违约率的均值，并映射出新的特征
    
      （'homeOwnership','verificationStatus','purpose','initialListStatus','applicationType','term','grade','subGrade','employmentLength'）
      
    频率编码

      因工作职称、贷款名称等数据已做脱敏处理，且数据密度高，此时我在这里采取频率编码的方法，并映射出新的特征
      
    特征交叉

      ('loanAmnt', 'installment', 'interestRate', 'annualIncome', 'dti', 'ficoRangeLow','ficoRangeHigh','openAcc','revolBal','revolUtil', 'totalAcc')
      
      将贷款金额（loanAmnt）与在贷款年限（term）关于贷款金额的统计特征（均值）的比值，并映射出新的特征 以此类推做特征交叉
      
    特征变换-分箱

    在这里的连续特征分箱环节，我采用卡方分箱，分箱过后对原始连续变量做woe特征转换，将变量转换为数值型特征；（此处尝试过同时对所有变量做woe编码，模型效果下降）
    
    特征选择

    在特征选择环节，我通过筛选变量IV值高于0.02、相关系数值低于0.95、psi低于0.1的特征变量作为入模特征，特征值由原来的维数567降为78个，做好特征工程后就开始下一步建模评估了。
  (3)建模与评估:
  
    在最后环节 我使用lgb模型进行建模预测,将原数据集分为训练集和验证集，并使用贝叶斯调参，找出较优参数在验证集上验证，以KS作为模型评估标准，训练集KS为36.2%验证集KS为33.8%,相差在5%以内；

    其次生成模型报告，从负样本捕获率看，在第十分箱已经可以捕获80%的坏样本了，且每箱负样本比率一直在下降，模型效果不错；

    最后模型评分映射将样本分为A,B,C,D三个等级。

